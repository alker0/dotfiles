" ---- manage plugins
function! PackInit() abort
  if &compatible
    set nocompatable
  endif

  packadd minpac

  call minpac#init()

  call minpac#add('k-takata/minpac', #{type: 'opt'})

  const sed_text =<< trim EOT
    s%(match +goTplIdentifier [^/]*/[^/]*)\\s([^/]*/)%\1[:blank:]\2%i
    s%(match +goTplIdentifier .+])(\+\\)%\1\\\2%i
  EOT

  call minpac#add('fatih/vim-go', #{do: {->system("sed -i -E '" . sed_text . "' syntax/gotexttmpl.vim")}})
endfunction

command! PackUpdate call PackInit() | call minpac#update()
command! PackClean call PackInit() | call minpac#clean()
command! PackStatus packadd minpac | call minpac#status()

augroup vimrc_autocmd
  autocmd!
augroup END

" ---- disable settings ----
let loaded_netrwPlugin=1

filetype indent off

" ---- encoding ----
set encoding=utf-8

set fileencodings=iso-2022-jp,euc-jp,sjis,utf-8

" ---- move ----
" Wrap cursor on Left/Right side
set whichwrap+=<,>,h,l,[,]

set virtualedit+=block

set scrolloff=5

function! s:fixScroll()
  set scroll=5
  augroup vimrc_autocmd
    autocmd VimResized * set scroll=5
  augroup END
endfunction

augroup vimrc_autocmd
  autocmd VimEnter * call s:fixScroll()
augroup END

" ---- search ----
set ignorecase

set smartcase

" Loop on search after bottom
set wrapscan

" ---- editor ----
set tabstop=2

set shiftwidth=2

set expandtab

set autoindent

set smartindent

" Deletable things by <BS>
" Start => Start position of insert
set backspace=indent,eol,start

set wildmenu

"set nrformats=alpha
set nrformats=

set ttimeout
set timeoutlen=500
set ttimeoutlen=100

" Include multi byte caractors to format target
set formatoptions+=mM

augroup vimrc_autocmd
  " Disable auto comment out
  "set formatoptions-=ro
  autocmd FileType * set formatoptions-=ro
augroup END

" ---- visual ----
set wrap

set showmatch

" Show invisible charactor
set list

" Trail => Space on line end
" Extends => Show when there are on over right side caractors
set listchars=tab:>-,extends:<,trail:-,eol:<

let &showbreak = '+++ '

" Line number
set number

set nocursorline

set nocursorcolumn

colorscheme desert

set title

" set term=xterm-256color

" ---- bottom info ----
" Cursor info
set ruler

set laststatus=2

set cmdheight=2

" Show normal mode command typing
set showcmd

" ---- side effect files ----
set nobackup

set noundofile

" default -> ' < s h
" other -> ! % / : @ c f n r
"set viminfo=

" ---- terminal ----
if &shell =~ '\v.*/(|[bd]a|[ackz]|tc|fi)sh'
  let &shell.=' --login'
endif

" ---- key mapping ----

nnoremap <C-f> <C-f>zz
nnoremap <C-b> <C-b>zz

inoremap jj <C-[>

